import Dashboard from"./views/Dashboard.js";import Posts from"./views/Posts.js";import PostView from"./views/PostView.js";import Settings from"./views/Settings.js";import About from"./views/About.js";const pathToRegex=t=>new RegExp("^"+t.replace(/\//g,"\\/").replace(/:\w+/g,"(.+)")+"$"),getParams=t=>{const e=t.result.slice(1),a=Array.from(t.route.path.matchAll(/:(\w+)/g)).map(t=>t[1]);return Object.fromEntries(a.map((t,a)=>[t,e[a]]))},navigateTo=t=>{history.pushState(null,null,t),router()},router=async()=>{const t=[{path:"/",view:Dashboard,args:insights},{path:"/videos",view:Posts,args:insights},{path:"/videos/:id",view:PostView,args:insights},{path:"/recommend",view:Settings,args:insights},{path:"/about",view:About,args:insights}];let e=t.map(t=>({route:t,result:location.pathname.match(pathToRegex(t.path))})).find(t=>null!==t.result);e||(e={route:t[0],result:[location.pathname]});const a=new e.route.view(getParams(e)),o=e.route.args;null==o?(document.querySelector("#app").innerHTML=await a.getHtml(),setTimeout(()=>{null==e.route.args&&navigateTo(location.pathname)},2e3)):(document.querySelector("#app").innerHTML=await a.getHtml(o),"loadVideo"in a&&await a.loadVideo())};window.addEventListener("popstate",router),document.addEventListener("DOMContentLoaded",()=>{document.body.addEventListener("click",t=>{t.target.matches("[data-link]")&&(t.preventDefault(),navigateTo(t.target.href))}),router()});